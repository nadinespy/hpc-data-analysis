================================================================================
PART 1: cpus_req vs AllocCPUS (TRES ID 1 from tres_alloc)
================================================================================

Note: sacct's AllocCPUS is not a column — it's parsed from tres_alloc.
tres_alloc has format '1=N,...' where TRES ID 1 = CPU.
tres_alloc column: ('tres_alloc', 'text', 'NO', '', "''", '')

cpus_req vs AllocCPUS (top 30 combos by frequency):
    cpus_req    alloc_cpus       count       comparison
           1             1    19079807            EQUAL
           8             8     2227747            EQUAL
           1             2     1502824      alloc > req
           4             4     1499639            EQUAL
           5             5     1435626            EQUAL
           2             2     1252431            EQUAL
          16            16      817871            EQUAL
           6             6      633083            EQUAL
          10            10      496942            EQUAL
          12            12      339924            EQUAL
           3             3      265240            EQUAL
         100           100      242654            EQUAL
          32            32      202624            EQUAL
          20            20      116117            EQUAL
          22            22       79012            EQUAL
          28            28       43268            EQUAL
          30            30       39497            EQUAL
          24            24       32145            EQUAL
          14            14       31768            EQUAL
           1            28       27656      alloc > req
           7             7       23716            EQUAL
          64            64       22086            EQUAL
           5             6       17286      alloc > req
          24            28       16379      alloc > req
          50            50       15122            EQUAL
          40            40       14960            EQUAL
           1            32       13365      alloc > req
          25            25       11157            EQUAL
          15            15       11145            EQUAL
          10             0       10981      alloc < req

Summary: total=30707549, equal=29024524, differ=1683025

Sample jobs where cpus_req != AllocCPUS:
      id_job    cpus_req    alloc_cpus   nodes  tres_req  /  tres_alloc
    31605470           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605458           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605206           1             2       1  1=1,2=1000,4=1,1001=1  /  1=2,2=2000,4=1,1001=1
    31605205           1             2       1  1=1,2=1000,4=1,1001=1  /  1=2,2=2000,4=1,1001=1
    31605173           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605139           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605138           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605137           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605136           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1
    31605135           1             2       1  1=1,2=32768,4=1,1001=1  /  1=2,2=32768,3=18446744073709551614,4=1,1001=1

================================================================================
PART 1b: cpus_req vs ReqCPUS (TRES ID 1 from tres_req)
================================================================================

Checking if cpus_req column matches the CPU value encoded in tres_req.

cpus_req vs tres_req CPU (top 30 combos by frequency):
    cpus_req    tres_req_cpu       count       comparison
           1               1    20675348            EQUAL
           8               8     2229817            EQUAL
           4               4     1501644            EQUAL
           5               5     1453037            EQUAL
           2               2     1255173            EQUAL
          16              16      818618            EQUAL
           6               6      633338            EQUAL
          10              10      508090            EQUAL
          12              12      341450            EQUAL
           3               3      266184            EQUAL
         100             100      242715            EQUAL
          32              32      203829            EQUAL
          20              20      116307            EQUAL
          22              22       79015            EQUAL
          24              24       48660            EQUAL
          28              28       43419            EQUAL
          30              30       39598            EQUAL
          14              14       31830            EQUAL
           7               7       25693            EQUAL
          64              64       22293            EQUAL
          50              50       15152            EQUAL
          40              40       15012            EQUAL
          25              25       14690            EQUAL
          15              15       11360            EQUAL
          84              84       10797            EQUAL
          18              18        9254            EQUAL
          60              60        9206            EQUAL
          36              36        7996            EQUAL
          11              11        7164            EQUAL
         112             112        7106            EQUAL

Summary: total=30707549, equal=30707226, differ=323

Sample jobs where cpus_req != tres_req CPU:
      id_job    cpus_req    tres_req_cpu  tres_req
    21256757           5               6  1=6,2=12000,4=1,5=6
    21256743           1               2  1=2,4=1,5=2
    21256713           1               2  1=2,2=64000,4=1,5=2
    21256618           1               2  1=2,2=40960,4=1,5=2
    21256468           1               2  1=2,2=81920,4=1,5=2
    21255272           5               6  1=6,2=18000,4=1,5=6
    21252758           1               2  1=2,2=512000,4=1,5=2
    21250145           1               2  1=2,2=512000,4=1,5=2
    21250144           1               2  1=2,2=512000,4=1,5=2
    21250143           1               2  1=2,2=512000,4=1,5=2

================================================================================
PART 2: mem_req flag bit (--mem vs --mem-per-cpu)
================================================================================
mem_req column: ('mem_req', 'bigint(20) unsigned', 'NO', '', '0', '')

All memory-related columns in create_job_table:
  ('mem_req', 'bigint(20) unsigned', 'NO', '', '0', '')

mem_req flag bit distribution (bit 63 = --mem-per-cpu):
         per-node (no flag):   30707549 jobs

================================================================================
PART 3: mem_req vs tres_req memory for --mem-per-cpu jobs
================================================================================

--mem-per-cpu jobs with cpus_req > 1:
      id_job   cpus   mem_req_raw     mem_value    tres_mem   tres_mem/cpus  tres_req
    31605471      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605469      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605464      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605463      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605457      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605456      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605451      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605450      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605448      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605447      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605445      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605444      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605435      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605434      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1
    31605432      8  9223372036854776808          1000        8000            1000  1=8,2=8000,4=1,1001=1

Verification: for --mem-per-cpu jobs, does (mem_value × cpus_req) = tres_mem?
  --mem-per-cpu jobs: total=17310356, match=17307697, differ=2659
  Match rate: 100.0%

Sample --mem-per-cpu jobs (showing mem_value × cpus = calculated vs tres_mem):
      id_job   cpus   mem_value    calculated    tres_mem   match?
    31605471      8        1000          8000        8000      YES
    31605469      8        1000          8000        8000      YES
    31605464      8        1000          8000        8000      YES
    31605463      8        1000          8000        8000      YES
    31605459      1        1000          1000        1000      YES
    31605457      8        1000          8000        8000      YES
    31605456      8        1000          8000        8000      YES
    31605451      8        1000          8000        8000      YES
    31605450      8        1000          8000        8000      YES
    31605448      8        1000          8000        8000      YES

For --mem (per-node) jobs, mem_value should equal tres_mem directly:
  --mem (per-node) jobs: total=12321890, match=12307157, differ=14733
  Match rate: 99.9%

Sample --mem (per-node) jobs:
      id_job   cpus     mem_value    tres_mem    match?
    31605427    100        131072      131072       YES
    31605426    100        131072      131072       YES
    31605419    100        131072      131072       YES
    31605418    100        131072      131072       YES
    31605414    100        131072      131072       YES
    31605409    100        131072      131072       YES
    31605405    100        131072      131072       YES
    31605404    100        131072      131072       YES
    31605400    100        131072      131072       YES
    31605399    100        131072      131072       YES

================================================================================
PART 4: Jobs with apparent memory efficiency > 100% — which mem type?
================================================================================

Completed jobs where maxrss > tres_req_mem * 1M (apparent mem eff > 100%):
      id_job   cpus  mem_type     mem_val    tres_mem           maxrss      eff%
    31605206      1   per-cpu        1000        1000       2082955264    198.6%
    31596978      4  per-node       65536       65536     221284032512    322.0%
    31595929      1   per-cpu        1000        1000       2083176448    198.7%
    31595842      1   per-cpu        1000        1000       2083049472    198.7%
    31595193      1   per-cpu        1000        1000       2083172352    198.7%
    31594795      1   per-cpu        1000        1000       2083180544    198.7%
    31594319      1   per-cpu        1000        1000       2083024896    198.7%
    31592003      1   per-cpu        1000        1000       2083139584    198.7%
    31590192      1   per-cpu        1000        1000       2083028992    198.7%
    31590122      4  per-node       65536       65536     242938900480    353.5%
    31588494      4  per-node       16384       16384      27149352960    158.0%
    31588423      1   per-cpu        1000        1000       2083069952    198.7%
    31587986      1   per-cpu        1000        1000       6505197568    620.4%
    31587981      1   per-cpu        1000        1000       6938701824    661.7%
    31587980      1   per-cpu        1000        1000       6943424512    662.2%
    31587978      1   per-cpu        1000        1000       6941999104    662.0%
    31587977      1   per-cpu        1000        1000       6940889088    661.9%
    31587973      1   per-cpu        1000        1000       6940352512    661.9%
    31587972      1   per-cpu        1000        1000       6499356672    619.8%
    31587971      1   per-cpu        1000        1000       7410343936    706.7%

Breakdown of mem eff > 100% jobs by memory request type:
     per-cpu:  1641990 jobs
    per-node:   449032 jobs

Output saved to cpu_mem_diagnostics_output.txt

